<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>404Fixers - IT Support</title>
  <link rel="icon" href="/favicon.ico" type="image/x-icon">
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
  <link rel="stylesheet" href="/css/styles.css" />
</head>
<body>
  <header class="hero">
    <div class="hero-content">
      <h1>ðŸ§  404Fixers</h1>
      <p>Where broken tech meets smart solutions.</p>
    </div>
  </header>

  <main class="main-content">
    <section class="card">
      <h2>ðŸ’¬ Talk to our AI Agent</h2>
      <p>Need help? Tap the chat bubble in the corner to speak with our AI agent.</p>
    </section>
  </main>

  <!-- Chatbot Toggle Button -->
  <div class="chat-toggle" onclick="toggleChat()">
    ðŸ’¬ Chat with 404Fixers
  </div>

  <!-- Chatbot Widget -->
  <div class="chatbot-widget" id="chatbotWidget">
    <div class="chatbot-header">
      <span>404Fixers AI Agent</span>
      <button onclick="toggleChat()">âœ–</button>
    </div>
    <div class="chatbot-body" id="chatMessages"></div>
    <div class="chatbot-input">
      <input type="text" id="userInput" placeholder="Ask me anything..." />
      <button onclick="sendMessage()">âž¤</button>
    </div>
  </div>

  <footer>
    <p>&copy; 2025 <strong>404Fixers</strong>. We fix what others fear.</p>
  </footer>

  <script>
    const chatflowId = "791afaea-62ec-403a-895c-546a2bc1752b";
    const apiUrl = "https://johnmiyahar-404fixers.hf.space/api/v1/prediction";

    function toggleChat() {
      const widget = document.getElementById('chatbotWidget');
      widget.style.display = widget.style.display === 'none' ? 'flex' : 'none';
    }

    async function sendMessage() {
      const inputField = document.getElementById('userInput');
      const message = inputField.value.trim();
      if (!message) return;

      appendMessage('user', message);
      inputField.value = '';

      try {
        const res = await fetch(`${apiUrl}`, {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify({
            chatflowid: chatflowId,
            question: message
          })
        });

        const data = await res.json();
        const reply = data.text || "Sorry, I couldn't understand that.";
        appendMessage('bot', reply);
      } catch (err) {
        appendMessage('bot', "Error: Unable to reach AI.");
      }
    }

    function appendMessage(sender, text) {
      const chat = document.getElementById('chatMessages');
      const messageDiv = document.createElement('div');
      messageDiv.className = sender;
      messageDiv.textContent = text;
      chat.appendChild(messageDiv);
      chat.scrollTop = chat.scrollHeight;
    }

    // Optional: open on desktop by default
    window.addEventListener('DOMContentLoaded', () => {
      if (window.innerWidth > 768) {
        document.getElementById('chatbotWidget').style.display = 'none';
      }
    });
  </script>
</body>
</html>
